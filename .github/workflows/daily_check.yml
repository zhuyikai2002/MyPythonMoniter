name: Debug Push

on:
  workflow_dispatch: # åªèƒ½æ‰‹åŠ¨è§¦å‘

jobs:
  debug_job:
    runs-on: ubuntu-latest
    permissions:
      contents: write

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Force Update and Debug
        run: |
          git config --global user.name "DebugBot"
          git config --global user.email "debug@example.com"
          
          # 1. å¼ºåˆ¶å†™å…¥å½“å‰æ—¶é—´ï¼Œä¿è¯æ–‡ä»¶ä¸€å®šå˜ï¼
          date +%s > debug_timestamp.txt
          git add debug_timestamp.txt
          git commit -m "Debug: Force update timestamp"
          
          # 2. è¯Šæ–­é’¥åŒ™ (åªæ˜¾ç¤ºå‰ä¸¤ä½ï¼Œä¸æ³„éœ²å¯†ç )
          TOKEN="${{ secrets.MY_PAT }}"
          if [ -z "$TOKEN" ]; then
            echo "âŒ ä¸¥é‡é”™è¯¯: secrets.MY_PAT æ˜¯ç©ºçš„ï¼è¯·å» Settings æ£€æŸ¥åå­—æ˜¯ä¸æ˜¯å†™é”™äº†ï¼"
            exit 1
          else
            echo "âœ… æ£€æµ‹åˆ° secrets.MY_PAT (é•¿åº¦: ${#TOKEN})"
            echo "å‰ä¸¤ä½æ˜¯: ${TOKEN:0:2}..."
          fi
          
          # 3. å°è¯•æ¨é€
          echo "ğŸš€ æ­£åœ¨å°è¯•æ¨é€..."
          git push "https://${{ secrets.MY_PAT }}@github.com/${{ github.repository }}.git" HEAD:main